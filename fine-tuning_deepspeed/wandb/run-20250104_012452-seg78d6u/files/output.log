[2025-01-04 01:24:53,895] [INFO] [comm.py:652:init_distributed] cdb=None
Loading checkpoint shards:  33%|████████████████████████████                                                        | 1/3 [00:10<00:21, 10.51s/it]
[rank3]: Traceback (most recent call last):
[rank3]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 142, in <module>
[rank3]:     main()
[rank3]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 60, in main
[rank3]:     model, tokenizer, model_type = load_model_and_tokenizer(args.model_path, args.local_rank)
[rank3]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/model.py", line 44, in load_model_and_tokenizer
[rank3]:     model=AutoModelForCausalLM.from_pretrained(
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
[rank3]:     return model_class.from_pretrained(
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 4264, in from_pretrained
[rank3]:     ) = cls._load_pretrained_model(
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 4777, in _load_pretrained_model
[rank3]:     new_error_msgs, offload_index, state_dict_index = _load_state_dict_into_meta_model(
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 942, in _load_state_dict_into_meta_model
[rank3]:     set_module_tensor_to_device(model, param_name, param_device, **set_module_kwargs)
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/accelerate/utils/modeling.py", line 329, in set_module_tensor_to_device
[rank3]:     new_value = value.to(device)
[rank3]: KeyboardInterrupt
[rank3]: Traceback (most recent call last):
[rank3]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 142, in <module>
[rank3]:     main()
[rank3]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 60, in main
[rank3]:     model, tokenizer, model_type = load_model_and_tokenizer(args.model_path, args.local_rank)
[rank3]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/model.py", line 44, in load_model_and_tokenizer
[rank3]:     model=AutoModelForCausalLM.from_pretrained(
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
[rank3]:     return model_class.from_pretrained(
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 4264, in from_pretrained
[rank3]:     ) = cls._load_pretrained_model(
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 4777, in _load_pretrained_model
[rank3]:     new_error_msgs, offload_index, state_dict_index = _load_state_dict_into_meta_model(
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 942, in _load_state_dict_into_meta_model
[rank3]:     set_module_tensor_to_device(model, param_name, param_device, **set_module_kwargs)
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/accelerate/utils/modeling.py", line 329, in set_module_tensor_to_device
[rank3]:     new_value = value.to(device)
[rank3]: KeyboardInterrupt
