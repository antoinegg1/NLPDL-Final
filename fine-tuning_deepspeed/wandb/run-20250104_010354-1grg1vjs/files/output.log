Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████| 3/3 [03:07<00:00, 62.44s/it]
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Traceback (most recent call last):
  File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 142, in <module>
    main()
  File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 60, in main
    model, tokenizer, model_type = load_model_and_tokenizer(args.model_path, args.local_rank)
  File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/model.py", line 42, in load_model_and_tokenizer
    model.resize_token_embeddings(len(tokenizer))
  File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 2117, in resize_token_embeddings
    model_embeds = self._resize_token_embeddings(new_num_tokens, pad_to_multiple_of, mean_resizing)
  File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 2142, in _resize_token_embeddings
    new_embeddings = self._get_resized_embeddings(
  File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 2296, in _get_resized_embeddings
    self._init_added_embeddings_weights_with_mean(
  File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 2474, in _init_added_embeddings_weights_with_mean
    eigenvalues = torch.linalg.eigvals(covariance)
KeyboardInterrupt
Traceback (most recent call last):
  File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 142, in <module>
    main()
  File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 60, in main
    model, tokenizer, model_type = load_model_and_tokenizer(args.model_path, args.local_rank)
  File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/model.py", line 42, in load_model_and_tokenizer
    model.resize_token_embeddings(len(tokenizer))
  File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 2117, in resize_token_embeddings
    model_embeds = self._resize_token_embeddings(new_num_tokens, pad_to_multiple_of, mean_resizing)
  File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 2142, in _resize_token_embeddings
    new_embeddings = self._get_resized_embeddings(
  File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 2296, in _get_resized_embeddings
    self._init_added_embeddings_weights_with_mean(
  File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 2474, in _init_added_embeddings_weights_with_mean
    eigenvalues = torch.linalg.eigvals(covariance)
KeyboardInterrupt
