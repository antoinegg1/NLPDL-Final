INFO:__main__:Loaded model_type: /mnt/file2/changye/model/NLP/Qwen2.5-1.5B-Instruct
INFO:__main__:Dataset loaded successfully.
INFO:__main__:Dataset tokenized successfully.
/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/training_args.py:1575: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
[2025-01-03 20:12:45,871] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
INFO:root:gcc -pthread -B /home/changye/miniconda3/envs/ML/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/changye/miniconda3/envs/ML/include -fPIC -O2 -isystem /home/changye/miniconda3/envs/ML/include -fPIC -c /tmp/tmpe6slgyn6/test.c -o /tmp/tmpe6slgyn6/test.o
INFO:root:gcc -pthread -B /home/changye/miniconda3/envs/ML/compiler_compat /tmp/tmpe6slgyn6/test.o -laio -o /tmp/tmpe6slgyn6/a.out
INFO:root:gcc -pthread -B /home/changye/miniconda3/envs/ML/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/changye/miniconda3/envs/ML/include -fPIC -O2 -isystem /home/changye/miniconda3/envs/ML/include -fPIC -c /tmp/tmplq1t0zx2/test.c -o /tmp/tmplq1t0zx2/test.o
INFO:root:gcc -pthread -B /home/changye/miniconda3/envs/ML/compiler_compat /tmp/tmplq1t0zx2/test.o -L/usr/local/cuda -L/usr/local/cuda/lib64 -lcufile -o /tmp/tmplq1t0zx2/a.out
[2025-01-03 20:12:47,017] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-01-03 20:12:47,018] [INFO] [comm.py:683:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py:117: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
INFO:__main__:Starting training with DeepSpeed & W&B logging...
                                                                                                                                     
{'loss': 2.9017, 'grad_norm': 5.024621486663818, 'learning_rate': 3e-06, 'epoch': 0.05}
                                                                                                                                     
{'eval_loss': 2.2585175037384033, 'eval_runtime': 17.6381, 'eval_samples_per_second': 226.782, 'eval_steps_per_second': 7.087, 'epoch': 0.05}
{'loss': 2.2009, 'grad_norm': 3.85324764251709, 'learning_rate': 8.000000000000001e-06, 'epoch': 0.1}
{'eval_loss': 2.132246494293213, 'eval_runtime': 17.981, 'eval_samples_per_second': 222.457, 'eval_steps_per_second': 6.952, 'epoch': 0.1}
{'loss': 2.1222, 'grad_norm': 3.9110071659088135, 'learning_rate': 1.3000000000000001e-05, 'epoch': 0.15}
{'eval_loss': 2.102538585662842, 'eval_runtime': 17.6293, 'eval_samples_per_second': 226.895, 'eval_steps_per_second': 7.09, 'epoch': 0.15}
{'loss': 2.0846, 'grad_norm': 3.660696506500244, 'learning_rate': 1.8e-05, 'epoch': 0.2}
{'eval_loss': 2.083329677581787, 'eval_runtime': 17.6206, 'eval_samples_per_second': 227.007, 'eval_steps_per_second': 7.094, 'epoch': 0.2}
{'loss': 2.0922, 'grad_norm': 3.006822347640991, 'learning_rate': 2.3000000000000003e-05, 'epoch': 0.25}
{'eval_loss': 2.0757203102111816, 'eval_runtime': 17.642, 'eval_samples_per_second': 226.731, 'eval_steps_per_second': 7.085, 'epoch': 0.25}
{'loss': 2.0904, 'grad_norm': 3.3685688972473145, 'learning_rate': 2.8000000000000003e-05, 'epoch': 0.3}
{'eval_loss': 2.0727362632751465, 'eval_runtime': 17.7183, 'eval_samples_per_second': 225.756, 'eval_steps_per_second': 7.055, 'epoch': 0.3}
{'loss': 2.081, 'grad_norm': 2.9376649856567383, 'learning_rate': 3.3e-05, 'epoch': 0.35}
{'eval_loss': 2.0695488452911377, 'eval_runtime': 17.6089, 'eval_samples_per_second': 227.158, 'eval_steps_per_second': 7.099, 'epoch': 0.35}
{'loss': 2.0802, 'grad_norm': 2.758139133453369, 'learning_rate': 3.8e-05, 'epoch': 0.4}
{'eval_loss': 2.070812463760376, 'eval_runtime': 17.5995, 'eval_samples_per_second': 227.279, 'eval_steps_per_second': 7.102, 'epoch': 0.4}
{'loss': 2.1071, 'grad_norm': 3.1511192321777344, 'learning_rate': 4.3e-05, 'epoch': 0.45}
{'eval_loss': 2.075256824493408, 'eval_runtime': 17.6188, 'eval_samples_per_second': 227.03, 'eval_steps_per_second': 7.095, 'epoch': 0.45}
{'loss': 2.086, 'grad_norm': 2.833688497543335, 'learning_rate': 4.8e-05, 'epoch': 0.5}
{'eval_loss': 2.0731899738311768, 'eval_runtime': 17.705, 'eval_samples_per_second': 225.925, 'eval_steps_per_second': 7.06, 'epoch': 0.5}
{'loss': 2.0868, 'grad_norm': 2.530747175216675, 'learning_rate': 4.94e-05, 'epoch': 0.55}
{'eval_loss': 2.078310966491699, 'eval_runtime': 17.6222, 'eval_samples_per_second': 226.987, 'eval_steps_per_second': 7.093, 'epoch': 0.55}
{'loss': 2.0585, 'grad_norm': 2.288802146911621, 'learning_rate': 4.8400000000000004e-05, 'epoch': 0.6}
{'eval_loss': 2.0683958530426025, 'eval_runtime': 17.6341, 'eval_samples_per_second': 226.833, 'eval_steps_per_second': 7.089, 'epoch': 0.6}
{'loss': 2.0782, 'grad_norm': 2.413132905960083, 'learning_rate': 4.74e-05, 'epoch': 0.65}
{'eval_loss': 2.061396598815918, 'eval_runtime': 17.6096, 'eval_samples_per_second': 227.149, 'eval_steps_per_second': 7.098, 'epoch': 0.65}
{'loss': 2.0618, 'grad_norm': 2.586730480194092, 'learning_rate': 4.64e-05, 'epoch': 0.7}
{'eval_loss': 2.0566587448120117, 'eval_runtime': 17.5707, 'eval_samples_per_second': 227.652, 'eval_steps_per_second': 7.114, 'epoch': 0.7}
{'loss': 2.0492, 'grad_norm': 2.4805312156677246, 'learning_rate': 4.5400000000000006e-05, 'epoch': 0.75}
{'eval_loss': 2.0452194213867188, 'eval_runtime': 17.6045, 'eval_samples_per_second': 227.214, 'eval_steps_per_second': 7.1, 'epoch': 0.75}
{'loss': 2.0493, 'grad_norm': 2.5580971240997314, 'learning_rate': 4.44e-05, 'epoch': 0.8}
{'eval_loss': 2.040412187576294, 'eval_runtime': 17.5747, 'eval_samples_per_second': 227.599, 'eval_steps_per_second': 7.112, 'epoch': 0.8}
{'loss': 2.0331, 'grad_norm': 2.4214041233062744, 'learning_rate': 4.3400000000000005e-05, 'epoch': 0.85}
{'eval_loss': 2.033397674560547, 'eval_runtime': 17.7262, 'eval_samples_per_second': 225.655, 'eval_steps_per_second': 7.052, 'epoch': 0.85}
{'loss': 2.0551, 'grad_norm': 2.349187135696411, 'learning_rate': 4.24e-05, 'epoch': 0.9}
{'eval_loss': 2.0283968448638916, 'eval_runtime': 17.5803, 'eval_samples_per_second': 227.527, 'eval_steps_per_second': 7.11, 'epoch': 0.9}
{'loss': 2.0145, 'grad_norm': 2.247429132461548, 'learning_rate': 4.14e-05, 'epoch': 0.95}
{'eval_loss': 2.0217366218566895, 'eval_runtime': 17.5989, 'eval_samples_per_second': 227.287, 'eval_steps_per_second': 7.103, 'epoch': 0.95}
{'loss': 2.0278, 'grad_norm': 2.1260647773742676, 'learning_rate': 4.0400000000000006e-05, 'epoch': 1.0}
{'eval_loss': 2.0149850845336914, 'eval_runtime': 17.5818, 'eval_samples_per_second': 227.508, 'eval_steps_per_second': 7.11, 'epoch': 1.0}
{'loss': 1.6184, 'grad_norm': 2.9100308418273926, 'learning_rate': 3.94e-05, 'epoch': 1.05}
{'eval_loss': 2.073838472366333, 'eval_runtime': 17.7216, 'eval_samples_per_second': 225.713, 'eval_steps_per_second': 7.054, 'epoch': 1.05}
{'loss': 1.6147, 'grad_norm': 2.4052445888519287, 'learning_rate': 3.8400000000000005e-05, 'epoch': 1.1}
{'eval_loss': 2.061998128890991, 'eval_runtime': 17.7063, 'eval_samples_per_second': 225.908, 'eval_steps_per_second': 7.06, 'epoch': 1.1}
{'loss': 1.622, 'grad_norm': 2.484726905822754, 'learning_rate': 3.74e-05, 'epoch': 1.15}
{'eval_loss': 2.0680525302886963, 'eval_runtime': 17.6044, 'eval_samples_per_second': 227.215, 'eval_steps_per_second': 7.1, 'epoch': 1.15}
{'loss': 1.6243, 'grad_norm': 2.6085541248321533, 'learning_rate': 3.6400000000000004e-05, 'epoch': 1.2}
{'eval_loss': 2.0539276599884033, 'eval_runtime': 17.6151, 'eval_samples_per_second': 227.077, 'eval_steps_per_second': 7.096, 'epoch': 1.2}
{'loss': 1.6323, 'grad_norm': 2.4757940769195557, 'learning_rate': 3.54e-05, 'epoch': 1.25}
{'eval_loss': 2.0500617027282715, 'eval_runtime': 17.7279, 'eval_samples_per_second': 225.633, 'eval_steps_per_second': 7.051, 'epoch': 1.25}
{'loss': 1.6503, 'grad_norm': 2.6694271564483643, 'learning_rate': 3.4399999999999996e-05, 'epoch': 1.3}
{'eval_loss': 2.048309326171875, 'eval_runtime': 17.602, 'eval_samples_per_second': 227.247, 'eval_steps_per_second': 7.101, 'epoch': 1.3}
{'loss': 1.6325, 'grad_norm': 2.596822500228882, 'learning_rate': 3.3400000000000005e-05, 'epoch': 1.35}
{'eval_loss': 2.047149419784546, 'eval_runtime': 17.5872, 'eval_samples_per_second': 227.438, 'eval_steps_per_second': 7.107, 'epoch': 1.35}
{'loss': 1.6314, 'grad_norm': 2.3457436561584473, 'learning_rate': 3.24e-05, 'epoch': 1.4}
{'eval_loss': 2.036609411239624, 'eval_runtime': 17.6025, 'eval_samples_per_second': 227.241, 'eval_steps_per_second': 7.101, 'epoch': 1.4}
{'loss': 1.6494, 'grad_norm': 2.4586758613586426, 'learning_rate': 3.1400000000000004e-05, 'epoch': 1.45}
{'eval_loss': 2.040456771850586, 'eval_runtime': 17.7191, 'eval_samples_per_second': 225.745, 'eval_steps_per_second': 7.055, 'epoch': 1.45}
{'loss': 1.6339, 'grad_norm': 2.341658592224121, 'learning_rate': 3.0420000000000004e-05, 'epoch': 1.5}
{'eval_loss': 2.0330066680908203, 'eval_runtime': 17.6171, 'eval_samples_per_second': 227.052, 'eval_steps_per_second': 7.095, 'epoch': 1.5}
{'loss': 1.6373, 'grad_norm': 2.2394375801086426, 'learning_rate': 2.9420000000000003e-05, 'epoch': 1.55}
{'eval_loss': 2.029170274734497, 'eval_runtime': 17.5716, 'eval_samples_per_second': 227.64, 'eval_steps_per_second': 7.114, 'epoch': 1.55}
{'loss': 1.6329, 'grad_norm': 2.1298513412475586, 'learning_rate': 2.8420000000000002e-05, 'epoch': 1.6}
{'eval_loss': 2.0209202766418457, 'eval_runtime': 17.6001, 'eval_samples_per_second': 227.272, 'eval_steps_per_second': 7.102, 'epoch': 1.6}
{'loss': 1.6211, 'grad_norm': 2.618781089782715, 'learning_rate': 2.7420000000000002e-05, 'epoch': 1.65}
{'eval_loss': 2.0194478034973145, 'eval_runtime': 17.7158, 'eval_samples_per_second': 225.788, 'eval_steps_per_second': 7.056, 'epoch': 1.65}
{'loss': 1.612, 'grad_norm': 2.3963446617126465, 'learning_rate': 2.642e-05, 'epoch': 1.7}
{'eval_loss': 2.011904716491699, 'eval_runtime': 17.6043, 'eval_samples_per_second': 227.217, 'eval_steps_per_second': 7.101, 'epoch': 1.7}
{'loss': 1.6172, 'grad_norm': 2.5285894870758057, 'learning_rate': 2.542e-05, 'epoch': 1.75}
{'eval_loss': 2.007289171218872, 'eval_runtime': 17.5742, 'eval_samples_per_second': 227.606, 'eval_steps_per_second': 7.113, 'epoch': 1.75}
{'loss': 1.6327, 'grad_norm': 2.341796398162842, 'learning_rate': 2.442e-05, 'epoch': 1.8}
{'eval_loss': 2.0005664825439453, 'eval_runtime': 17.6054, 'eval_samples_per_second': 227.203, 'eval_steps_per_second': 7.1, 'epoch': 1.8}
{'loss': 1.5981, 'grad_norm': 2.3125877380371094, 'learning_rate': 2.342e-05, 'epoch': 1.85}
{'eval_loss': 2.006333827972412, 'eval_runtime': 17.5743, 'eval_samples_per_second': 227.605, 'eval_steps_per_second': 7.113, 'epoch': 1.85}
{'loss': 1.6025, 'grad_norm': 2.5615739822387695, 'learning_rate': 2.2420000000000002e-05, 'epoch': 1.9}
{'eval_loss': 2.0035464763641357, 'eval_runtime': 17.5886, 'eval_samples_per_second': 227.42, 'eval_steps_per_second': 7.107, 'epoch': 1.9}
{'loss': 1.6121, 'grad_norm': 2.326739549636841, 'learning_rate': 2.142e-05, 'epoch': 1.95}
{'eval_loss': 1.9933732748031616, 'eval_runtime': 17.5749, 'eval_samples_per_second': 227.597, 'eval_steps_per_second': 7.112, 'epoch': 1.95}
{'loss': 1.6228, 'grad_norm': 2.304790496826172, 'learning_rate': 2.042e-05, 'epoch': 2.0}
{'eval_loss': 1.9861862659454346, 'eval_runtime': 17.5958, 'eval_samples_per_second': 227.327, 'eval_steps_per_second': 7.104, 'epoch': 2.0}
{'loss': 1.0109, 'grad_norm': 2.867656707763672, 'learning_rate': 1.942e-05, 'epoch': 2.05}
{'eval_loss': 2.2843401432037354, 'eval_runtime': 17.5856, 'eval_samples_per_second': 227.458, 'eval_steps_per_second': 7.108, 'epoch': 2.05}
{'loss': 0.9901, 'grad_norm': 2.978745460510254, 'learning_rate': 1.842e-05, 'epoch': 2.1}
{'eval_loss': 2.26021146774292, 'eval_runtime': 17.7091, 'eval_samples_per_second': 225.872, 'eval_steps_per_second': 7.059, 'epoch': 2.1}
{'loss': 0.9944, 'grad_norm': 3.042503833770752, 'learning_rate': 1.742e-05, 'epoch': 2.15}
{'eval_loss': 2.2783584594726562, 'eval_runtime': 17.5893, 'eval_samples_per_second': 227.412, 'eval_steps_per_second': 7.107, 'epoch': 2.15}
{'loss': 1.0078, 'grad_norm': 3.082653522491455, 'learning_rate': 1.6420000000000002e-05, 'epoch': 2.2}
{'eval_loss': 2.2901229858398438, 'eval_runtime': 17.5753, 'eval_samples_per_second': 227.592, 'eval_steps_per_second': 7.112, 'epoch': 2.2}
{'loss': 0.9981, 'grad_norm': 2.8629887104034424, 'learning_rate': 1.542e-05, 'epoch': 2.25}
{'eval_loss': 2.2990713119506836, 'eval_runtime': 17.5994, 'eval_samples_per_second': 227.281, 'eval_steps_per_second': 7.103, 'epoch': 2.25}
{'loss': 0.9986, 'grad_norm': 2.994662046432495, 'learning_rate': 1.4420000000000001e-05, 'epoch': 2.3}
{'eval_loss': 2.28605055809021, 'eval_runtime': 17.6979, 'eval_samples_per_second': 226.015, 'eval_steps_per_second': 7.063, 'epoch': 2.3}
{'loss': 0.9792, 'grad_norm': 2.842806339263916, 'learning_rate': 1.3420000000000002e-05, 'epoch': 2.35}
{'eval_loss': 2.283310890197754, 'eval_runtime': 17.5917, 'eval_samples_per_second': 227.38, 'eval_steps_per_second': 7.106, 'epoch': 2.35}
{'loss': 0.9872, 'grad_norm': 2.9037327766418457, 'learning_rate': 1.2420000000000001e-05, 'epoch': 2.4}
{'eval_loss': 2.29079532623291, 'eval_runtime': 17.567, 'eval_samples_per_second': 227.699, 'eval_steps_per_second': 7.116, 'epoch': 2.4}
{'loss': 0.9834, 'grad_norm': 2.8869810104370117, 'learning_rate': 1.142e-05, 'epoch': 2.45}
{'eval_loss': 2.27659273147583, 'eval_runtime': 17.6025, 'eval_samples_per_second': 227.241, 'eval_steps_per_second': 7.101, 'epoch': 2.45}
{'loss': 1.0068, 'grad_norm': 3.0010037422180176, 'learning_rate': 1.042e-05, 'epoch': 2.5}
{'eval_loss': 2.2682344913482666, 'eval_runtime': 17.7038, 'eval_samples_per_second': 225.94, 'eval_steps_per_second': 7.061, 'epoch': 2.5}
{'loss': 0.9952, 'grad_norm': 2.886406660079956, 'learning_rate': 9.420000000000001e-06, 'epoch': 2.55}
{'eval_loss': 2.2664687633514404, 'eval_runtime': 17.5971, 'eval_samples_per_second': 227.31, 'eval_steps_per_second': 7.103, 'epoch': 2.55}
{'loss': 0.9803, 'grad_norm': 3.1364614963531494, 'learning_rate': 8.42e-06, 'epoch': 2.6}
{'eval_loss': 2.2919652462005615, 'eval_runtime': 17.5745, 'eval_samples_per_second': 227.603, 'eval_steps_per_second': 7.113, 'epoch': 2.6}
{'loss': 0.9657, 'grad_norm': 2.7102980613708496, 'learning_rate': 7.420000000000001e-06, 'epoch': 2.65}
{'eval_loss': 2.2837512493133545, 'eval_runtime': 17.6191, 'eval_samples_per_second': 227.026, 'eval_steps_per_second': 7.095, 'epoch': 2.65}
{'loss': 0.9831, 'grad_norm': 3.260437488555908, 'learning_rate': 6.4199999999999995e-06, 'epoch': 2.7}
{'eval_loss': 2.2710375785827637, 'eval_runtime': 17.7117, 'eval_samples_per_second': 225.84, 'eval_steps_per_second': 7.057, 'epoch': 2.7}
{'loss': 0.9659, 'grad_norm': 2.673675298690796, 'learning_rate': 5.42e-06, 'epoch': 2.75}
{'eval_loss': 2.289184093475342, 'eval_runtime': 17.6048, 'eval_samples_per_second': 227.211, 'eval_steps_per_second': 7.1, 'epoch': 2.75}
{'loss': 0.9554, 'grad_norm': 2.931314706802368, 'learning_rate': 4.420000000000001e-06, 'epoch': 2.8}
{'eval_loss': 2.289241313934326, 'eval_runtime': 18.4976, 'eval_samples_per_second': 216.244, 'eval_steps_per_second': 6.758, 'epoch': 2.8}
{'loss': 0.9775, 'grad_norm': 2.64199161529541, 'learning_rate': 3.4200000000000003e-06, 'epoch': 2.85}
{'eval_loss': 2.277146100997925, 'eval_runtime': 17.601, 'eval_samples_per_second': 227.259, 'eval_steps_per_second': 7.102, 'epoch': 2.85}
{'loss': 0.962, 'grad_norm': 2.753049373626709, 'learning_rate': 2.42e-06, 'epoch': 2.9}
{'eval_loss': 2.2740113735198975, 'eval_runtime': 18.0097, 'eval_samples_per_second': 222.102, 'eval_steps_per_second': 6.941, 'epoch': 2.9}
{'loss': 0.9665, 'grad_norm': 2.93986177444458, 'learning_rate': 1.4200000000000002e-06, 'epoch': 2.95}
{'eval_loss': 2.279542922973633, 'eval_runtime': 17.59, 'eval_samples_per_second': 227.402, 'eval_steps_per_second': 7.106, 'epoch': 2.95}
{'loss': 0.9706, 'grad_norm': 2.983384609222412, 'learning_rate': 4.2e-07, 'epoch': 3.0}
{'eval_loss': 2.278473138809204, 'eval_runtime': 17.5765, 'eval_samples_per_second': 227.577, 'eval_steps_per_second': 7.112, 'epoch': 3.0}
{'train_runtime': 17086.8683, 'train_samples_per_second': 5.618, 'train_steps_per_second': 0.176, 'train_loss': 1.5756214243570963, 'epoch': 3.0}
