INFO:__main__:Loaded model_type: /mnt/file2/changye/model/NLP/Qwen2.5-1.5B-Instruct
INFO:__main__:Dataset loaded successfully.
INFO:__main__:Dataset tokenized successfully.
/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/training_args.py:1575: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
[2025-01-03 20:11:44,295] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
INFO:root:gcc -pthread -B /home/changye/miniconda3/envs/ML/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/changye/miniconda3/envs/ML/include -fPIC -O2 -isystem /home/changye/miniconda3/envs/ML/include -fPIC -c /tmp/tmpjdhr5kb6/test.c -o /tmp/tmpjdhr5kb6/test.o
INFO:root:gcc -pthread -B /home/changye/miniconda3/envs/ML/compiler_compat /tmp/tmpjdhr5kb6/test.o -laio -o /tmp/tmpjdhr5kb6/a.out
INFO:root:gcc -pthread -B /home/changye/miniconda3/envs/ML/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -fPIC -O2 -isystem /home/changye/miniconda3/envs/ML/include -fPIC -O2 -isystem /home/changye/miniconda3/envs/ML/include -fPIC -c /tmp/tmpbdy5slcw/test.c -o /tmp/tmpbdy5slcw/test.o
INFO:root:gcc -pthread -B /home/changye/miniconda3/envs/ML/compiler_compat /tmp/tmpbdy5slcw/test.o -L/usr/local/cuda -L/usr/local/cuda/lib64 -lcufile -o /tmp/tmpbdy5slcw/a.out
[2025-01-03 20:11:45,979] [INFO] [comm.py:652:init_distributed] cdb=None
/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py:117: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
INFO:__main__:Starting training with DeepSpeed & W&B logging...
[rank3]: Traceback (most recent call last):
[rank3]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 142, in <module>
[rank3]:     main()
[rank3]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 128, in main
[rank3]:     train_result = trainer.train()
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/trainer.py", line 2164, in train
[rank3]:     return inner_training_loop(
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/trainer.py", line 2262, in _inner_training_loop
[rank3]:     self.optimizer, self.lr_scheduler = deepspeed_init(self, num_training_steps=max_steps)
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/integrations/deepspeed.py", line 398, in deepspeed_init
[rank3]:     hf_deepspeed_config.trainer_config_finalize(args, model, num_training_steps)
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/integrations/deepspeed.py", line 270, in trainer_config_finalize
[rank3]:     raise ValueError(
[rank3]: ValueError: Please correct the following DeepSpeed config values that mismatch TrainingArguments values:
[rank3]: - ds train_batch_size=32 vs hf train_batch_size (calculated)=16
[rank3]: The easiest method is to set these DeepSpeed config values to 'auto'.
[rank3]: Traceback (most recent call last):
[rank3]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 142, in <module>
[rank3]:     main()
[rank3]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 128, in main
[rank3]:     train_result = trainer.train()
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/trainer.py", line 2164, in train
[rank3]:     return inner_training_loop(
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/trainer.py", line 2262, in _inner_training_loop
[rank3]:     self.optimizer, self.lr_scheduler = deepspeed_init(self, num_training_steps=max_steps)
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/integrations/deepspeed.py", line 398, in deepspeed_init
[rank3]:     hf_deepspeed_config.trainer_config_finalize(args, model, num_training_steps)
[rank3]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/integrations/deepspeed.py", line 270, in trainer_config_finalize
[rank3]:     raise ValueError(
[rank3]: ValueError: Please correct the following DeepSpeed config values that mismatch TrainingArguments values:
[rank3]: - ds train_batch_size=32 vs hf train_batch_size (calculated)=16
[rank3]: The easiest method is to set these DeepSpeed config values to 'auto'.
