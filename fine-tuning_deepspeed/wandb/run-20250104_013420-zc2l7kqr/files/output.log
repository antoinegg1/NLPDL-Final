[2025-01-04 01:34:21,465] [INFO] [comm.py:652:init_distributed] cdb=None
[rank2]: Traceback (most recent call last):
[rank2]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 142, in <module>
[rank2]:     main()
[rank2]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 60, in main
[rank2]:     model, tokenizer, model_type = load_model_and_tokenizer(args.model_path, args.local_rank)
[rank2]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/model.py", line 40, in load_model_and_tokenizer
[rank2]:     model, model_type = _load_model(model_name)
[rank2]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/model.py", line 76, in _load_model
[rank2]:     model = AutoModelForCausalLM.from_pretrained(
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
[rank2]:     return model_class.from_pretrained(
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 4130, in from_pretrained
[rank2]:     model = cls(config, *model_args, **model_kwargs)
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/deepspeed/runtime/zero/partition_parameters.py", line 511, in wrapper
[rank2]:     f(module, *args, **kwargs)
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/models/mistral/modeling_mistral.py", line 990, in __init__
[rank2]:     self.model = MistralModel(config)
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/deepspeed/runtime/zero/partition_parameters.py", line 511, in wrapper
[rank2]:     f(module, *args, **kwargs)
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/models/mistral/modeling_mistral.py", line 693, in __init__
[rank2]:     self.embed_tokens = nn.Embedding(config.vocab_size, config.hidden_size, self.padding_idx)
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/deepspeed/runtime/zero/partition_parameters.py", line 521, in wrapper
[rank2]:     self._post_init_method(module)
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/deepspeed/runtime/zero/partition_parameters.py", line 1087, in _post_init_method
[rank2]:     param.data = param.data.to(self.local_device)
[rank2]: NotImplementedError: Cannot copy out of meta tensor; no data!
[rank2]: Traceback (most recent call last):
[rank2]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 142, in <module>
[rank2]:     main()
[rank2]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/train.py", line 60, in main
[rank2]:     model, tokenizer, model_type = load_model_and_tokenizer(args.model_path, args.local_rank)
[rank2]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/model.py", line 40, in load_model_and_tokenizer
[rank2]:     model, model_type = _load_model(model_name)
[rank2]:   File "/mnt/file2/changye/NLPFINAL/fine-tuning_deepspeed/model.py", line 76, in _load_model
[rank2]:     model = AutoModelForCausalLM.from_pretrained(
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 564, in from_pretrained
[rank2]:     return model_class.from_pretrained(
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/modeling_utils.py", line 4130, in from_pretrained
[rank2]:     model = cls(config, *model_args, **model_kwargs)
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/deepspeed/runtime/zero/partition_parameters.py", line 511, in wrapper
[rank2]:     f(module, *args, **kwargs)
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/models/mistral/modeling_mistral.py", line 990, in __init__
[rank2]:     self.model = MistralModel(config)
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/deepspeed/runtime/zero/partition_parameters.py", line 511, in wrapper
[rank2]:     f(module, *args, **kwargs)
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/models/mistral/modeling_mistral.py", line 693, in __init__
[rank2]:     self.embed_tokens = nn.Embedding(config.vocab_size, config.hidden_size, self.padding_idx)
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/deepspeed/runtime/zero/partition_parameters.py", line 521, in wrapper
[rank2]:     self._post_init_method(module)
[rank2]:   File "/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/deepspeed/runtime/zero/partition_parameters.py", line 1087, in _post_init_method
[rank2]:     param.data = param.data.to(self.local_device)
[rank2]: NotImplementedError: Cannot copy out of meta tensor; no data!
