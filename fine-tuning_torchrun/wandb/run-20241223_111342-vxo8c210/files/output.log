训练集加载完成，共有 32000 个样本。
验证集加载完成，共有 4000 个样本。
Map: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 4000/4000 [00:11<00:00, 360.61 examples/s]
数据预处理完成。
/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/training_args.py:1575: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
/mnt/file2/changye/NLPFINAL/fine-tuning_torchrun/trainer.py:74: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
                                                                                                                                                             
{'loss': 3.1519, 'grad_norm': 3.2430577278137207, 'learning_rate': 4.999166666666667e-05, 'epoch': 0.0}
{'loss': 2.3808, 'grad_norm': 1.1847704648971558, 'learning_rate': 4.9175e-05, 'epoch': 0.05}
                                                                                                                                                             
{'eval_loss': 2.2617080211639404, 'eval_runtime': 20.9852, 'eval_samples_per_second': 190.61, 'eval_steps_per_second': 11.913, 'epoch': 0.05}
{'loss': 2.2939, 'grad_norm': 1.17861008644104, 'learning_rate': 4.834166666666667e-05, 'epoch': 0.1}
{'eval_loss': 2.230008840560913, 'eval_runtime': 21.1805, 'eval_samples_per_second': 188.853, 'eval_steps_per_second': 11.803, 'epoch': 0.1}
{'loss': 2.2675, 'grad_norm': 1.177267074584961, 'learning_rate': 4.750833333333334e-05, 'epoch': 0.15}
{'eval_loss': 2.2089128494262695, 'eval_runtime': 21.1502, 'eval_samples_per_second': 189.123, 'eval_steps_per_second': 11.82, 'epoch': 0.15}
{'loss': 2.2228, 'grad_norm': 1.213273048400879, 'learning_rate': 4.6675e-05, 'epoch': 0.2}
{'eval_loss': 2.1900885105133057, 'eval_runtime': 21.1018, 'eval_samples_per_second': 189.557, 'eval_steps_per_second': 11.847, 'epoch': 0.2}
{'loss': 2.2271, 'grad_norm': 1.0912610292434692, 'learning_rate': 4.5841666666666665e-05, 'epoch': 0.25}
{'eval_loss': 2.1771137714385986, 'eval_runtime': 20.9992, 'eval_samples_per_second': 190.483, 'eval_steps_per_second': 11.905, 'epoch': 0.25}
{'loss': 2.2044, 'grad_norm': 1.0669504404067993, 'learning_rate': 4.5008333333333334e-05, 'epoch': 0.3}
{'eval_loss': 2.1628007888793945, 'eval_runtime': 20.7698, 'eval_samples_per_second': 192.587, 'eval_steps_per_second': 12.037, 'epoch': 0.3}
{'loss': 2.2064, 'grad_norm': 1.3024324178695679, 'learning_rate': 4.4174999999999996e-05, 'epoch': 0.35}
{'eval_loss': 2.1509854793548584, 'eval_runtime': 20.9262, 'eval_samples_per_second': 191.148, 'eval_steps_per_second': 11.947, 'epoch': 0.35}
{'loss': 2.1831, 'grad_norm': 1.066835880279541, 'learning_rate': 4.334166666666667e-05, 'epoch': 0.4}
{'eval_loss': 2.141559362411499, 'eval_runtime': 21.3065, 'eval_samples_per_second': 187.736, 'eval_steps_per_second': 11.734, 'epoch': 0.4}
{'loss': 2.1949, 'grad_norm': 1.2610536813735962, 'learning_rate': 4.2508333333333334e-05, 'epoch': 0.45}
{'eval_loss': 2.1338748931884766, 'eval_runtime': 21.0678, 'eval_samples_per_second': 189.863, 'eval_steps_per_second': 11.866, 'epoch': 0.45}
{'loss': 2.164, 'grad_norm': 1.1132690906524658, 'learning_rate': 4.1675e-05, 'epoch': 0.5}
{'eval_loss': 2.1223642826080322, 'eval_runtime': 20.953, 'eval_samples_per_second': 190.903, 'eval_steps_per_second': 11.931, 'epoch': 0.5}
{'loss': 2.1716, 'grad_norm': 1.0901341438293457, 'learning_rate': 4.0841666666666666e-05, 'epoch': 0.55}
{'eval_loss': 2.116057872772217, 'eval_runtime': 20.8954, 'eval_samples_per_second': 191.43, 'eval_steps_per_second': 11.964, 'epoch': 0.55}
{'loss': 2.1362, 'grad_norm': 1.055993676185608, 'learning_rate': 4.0008333333333335e-05, 'epoch': 0.6}
{'eval_loss': 2.1061415672302246, 'eval_runtime': 20.6072, 'eval_samples_per_second': 194.107, 'eval_steps_per_second': 12.132, 'epoch': 0.6}
{'loss': 2.1433, 'grad_norm': 1.1027668714523315, 'learning_rate': 3.9175000000000004e-05, 'epoch': 0.65}
{'eval_loss': 2.1005756855010986, 'eval_runtime': 20.7382, 'eval_samples_per_second': 192.881, 'eval_steps_per_second': 12.055, 'epoch': 0.65}
{'loss': 2.1308, 'grad_norm': 1.1578203439712524, 'learning_rate': 3.834166666666667e-05, 'epoch': 0.7}
{'eval_loss': 2.092902898788452, 'eval_runtime': 20.7225, 'eval_samples_per_second': 193.027, 'eval_steps_per_second': 12.064, 'epoch': 0.7}
{'loss': 2.1271, 'grad_norm': 1.1439850330352783, 'learning_rate': 3.7508333333333335e-05, 'epoch': 0.75}
{'eval_loss': 2.087219715118408, 'eval_runtime': 20.5126, 'eval_samples_per_second': 195.002, 'eval_steps_per_second': 12.188, 'epoch': 0.75}
{'loss': 2.13, 'grad_norm': 1.1446635723114014, 'learning_rate': 3.6675000000000004e-05, 'epoch': 0.8}
{'eval_loss': 2.0818099975585938, 'eval_runtime': 21.16, 'eval_samples_per_second': 189.036, 'eval_steps_per_second': 11.815, 'epoch': 0.8}
{'loss': 2.1007, 'grad_norm': 1.1571544408798218, 'learning_rate': 3.5841666666666666e-05, 'epoch': 0.85}
{'eval_loss': 2.075273036956787, 'eval_runtime': 21.2704, 'eval_samples_per_second': 188.055, 'eval_steps_per_second': 11.753, 'epoch': 0.85}
{'loss': 2.1196, 'grad_norm': 1.110225796699524, 'learning_rate': 3.5008333333333335e-05, 'epoch': 0.9}
{'eval_loss': 2.0708775520324707, 'eval_runtime': 20.9684, 'eval_samples_per_second': 190.764, 'eval_steps_per_second': 11.923, 'epoch': 0.9}
{'loss': 2.0967, 'grad_norm': 1.1117759943008423, 'learning_rate': 3.4175000000000004e-05, 'epoch': 0.95}
{'eval_loss': 2.0653133392333984, 'eval_runtime': 21.0014, 'eval_samples_per_second': 190.463, 'eval_steps_per_second': 11.904, 'epoch': 0.95}
{'loss': 2.1067, 'grad_norm': 0.9631901383399963, 'learning_rate': 3.3341666666666666e-05, 'epoch': 1.0}
{'eval_loss': 2.0600991249084473, 'eval_runtime': 20.9793, 'eval_samples_per_second': 190.664, 'eval_steps_per_second': 11.917, 'epoch': 1.0}
{'loss': 1.8326, 'grad_norm': 1.335257649421692, 'learning_rate': 3.2508333333333335e-05, 'epoch': 1.05}
{'eval_loss': 2.07401180267334, 'eval_runtime': 20.8586, 'eval_samples_per_second': 191.767, 'eval_steps_per_second': 11.985, 'epoch': 1.05}
{'loss': 1.8385, 'grad_norm': 1.2336210012435913, 'learning_rate': 3.1675e-05, 'epoch': 1.1}
{'eval_loss': 2.0682880878448486, 'eval_runtime': 20.7942, 'eval_samples_per_second': 192.362, 'eval_steps_per_second': 12.023, 'epoch': 1.1}
{'loss': 1.8286, 'grad_norm': 1.2235314846038818, 'learning_rate': 3.0841666666666666e-05, 'epoch': 1.15}
{'eval_loss': 2.0703418254852295, 'eval_runtime': 20.7585, 'eval_samples_per_second': 192.692, 'eval_steps_per_second': 12.043, 'epoch': 1.15}
{'loss': 1.8443, 'grad_norm': 1.2264726161956787, 'learning_rate': 3.0008333333333332e-05, 'epoch': 1.2}
{'eval_loss': 2.0662949085235596, 'eval_runtime': 20.8962, 'eval_samples_per_second': 191.423, 'eval_steps_per_second': 11.964, 'epoch': 1.2}
{'loss': 1.8514, 'grad_norm': 1.296708106994629, 'learning_rate': 2.9175e-05, 'epoch': 1.25}
{'eval_loss': 2.0621824264526367, 'eval_runtime': 20.7411, 'eval_samples_per_second': 192.853, 'eval_steps_per_second': 12.053, 'epoch': 1.25}
{'loss': 1.8436, 'grad_norm': 1.3552098274230957, 'learning_rate': 2.8341666666666667e-05, 'epoch': 1.3}
{'eval_loss': 2.056227207183838, 'eval_runtime': 20.6205, 'eval_samples_per_second': 193.981, 'eval_steps_per_second': 12.124, 'epoch': 1.3}
{'loss': 1.854, 'grad_norm': 1.1052026748657227, 'learning_rate': 2.7508333333333336e-05, 'epoch': 1.35}
{'eval_loss': 2.0549230575561523, 'eval_runtime': 20.725, 'eval_samples_per_second': 193.004, 'eval_steps_per_second': 12.063, 'epoch': 1.35}
{'loss': 1.8356, 'grad_norm': 1.274726390838623, 'learning_rate': 2.6675e-05, 'epoch': 1.4}
{'eval_loss': 2.05342435836792, 'eval_runtime': 20.7889, 'eval_samples_per_second': 192.411, 'eval_steps_per_second': 12.026, 'epoch': 1.4}
{'loss': 1.858, 'grad_norm': 1.1886131763458252, 'learning_rate': 2.584166666666667e-05, 'epoch': 1.45}
{'eval_loss': 2.04915452003479, 'eval_runtime': 21.012, 'eval_samples_per_second': 190.367, 'eval_steps_per_second': 11.898, 'epoch': 1.45}
{'loss': 1.8193, 'grad_norm': 1.2226922512054443, 'learning_rate': 2.5008333333333332e-05, 'epoch': 1.5}
{'eval_loss': 2.047485589981079, 'eval_runtime': 20.7402, 'eval_samples_per_second': 192.862, 'eval_steps_per_second': 12.054, 'epoch': 1.5}
{'loss': 1.8342, 'grad_norm': 1.0259528160095215, 'learning_rate': 2.4175e-05, 'epoch': 1.55}
{'eval_loss': 2.04521107673645, 'eval_runtime': 20.8147, 'eval_samples_per_second': 192.172, 'eval_steps_per_second': 12.011, 'epoch': 1.55}
{'loss': 1.8335, 'grad_norm': 1.0590447187423706, 'learning_rate': 2.3341666666666667e-05, 'epoch': 1.6}
{'eval_loss': 2.04146671295166, 'eval_runtime': 20.8573, 'eval_samples_per_second': 191.779, 'eval_steps_per_second': 11.986, 'epoch': 1.6}
{'loss': 1.8441, 'grad_norm': 1.1880595684051514, 'learning_rate': 2.2508333333333333e-05, 'epoch': 1.65}
{'eval_loss': 2.0377418994903564, 'eval_runtime': 21.2596, 'eval_samples_per_second': 188.151, 'eval_steps_per_second': 11.759, 'epoch': 1.65}
{'loss': 1.8166, 'grad_norm': 1.2080589532852173, 'learning_rate': 2.1675e-05, 'epoch': 1.7}
{'eval_loss': 2.034778594970703, 'eval_runtime': 21.0263, 'eval_samples_per_second': 190.238, 'eval_steps_per_second': 11.89, 'epoch': 1.7}
{'loss': 1.8229, 'grad_norm': 1.2083513736724854, 'learning_rate': 2.0841666666666667e-05, 'epoch': 1.75}
{'eval_loss': 2.0334384441375732, 'eval_runtime': 20.81, 'eval_samples_per_second': 192.215, 'eval_steps_per_second': 12.013, 'epoch': 1.75}
{'loss': 1.8326, 'grad_norm': 1.19082510471344, 'learning_rate': 2.0008333333333333e-05, 'epoch': 1.8}
{'eval_loss': 2.031691312789917, 'eval_runtime': 20.9513, 'eval_samples_per_second': 190.919, 'eval_steps_per_second': 11.932, 'epoch': 1.8}
{'loss': 1.8258, 'grad_norm': 1.1866220235824585, 'learning_rate': 1.9175000000000002e-05, 'epoch': 1.85}
{'eval_loss': 2.0287818908691406, 'eval_runtime': 20.7898, 'eval_samples_per_second': 192.402, 'eval_steps_per_second': 12.025, 'epoch': 1.85}
{'loss': 1.8315, 'grad_norm': 1.1949982643127441, 'learning_rate': 1.8341666666666668e-05, 'epoch': 1.9}
{'eval_loss': 2.025587797164917, 'eval_runtime': 20.8533, 'eval_samples_per_second': 191.817, 'eval_steps_per_second': 11.989, 'epoch': 1.9}
{'loss': 1.8267, 'grad_norm': 1.1383951902389526, 'learning_rate': 1.7508333333333337e-05, 'epoch': 1.95}
{'eval_loss': 2.024749279022217, 'eval_runtime': 20.8294, 'eval_samples_per_second': 192.036, 'eval_steps_per_second': 12.002, 'epoch': 1.95}
{'loss': 1.8075, 'grad_norm': 1.1923375129699707, 'learning_rate': 1.6675000000000002e-05, 'epoch': 2.0}
{'eval_loss': 2.023178815841675, 'eval_runtime': 20.521, 'eval_samples_per_second': 194.922, 'eval_steps_per_second': 12.183, 'epoch': 2.0}
{'loss': 1.6132, 'grad_norm': 1.3082404136657715, 'learning_rate': 1.5841666666666668e-05, 'epoch': 2.05}
{'eval_loss': 2.0667049884796143, 'eval_runtime': 20.8759, 'eval_samples_per_second': 191.609, 'eval_steps_per_second': 11.976, 'epoch': 2.05}
{'loss': 1.6206, 'grad_norm': 1.3944040536880493, 'learning_rate': 1.5008333333333335e-05, 'epoch': 2.1}
{'eval_loss': 2.066871404647827, 'eval_runtime': 20.8048, 'eval_samples_per_second': 192.264, 'eval_steps_per_second': 12.016, 'epoch': 2.1}
{'loss': 1.6131, 'grad_norm': 1.390365481376648, 'learning_rate': 1.4183333333333335e-05, 'epoch': 2.15}
{'eval_loss': 2.063533306121826, 'eval_runtime': 20.7507, 'eval_samples_per_second': 192.765, 'eval_steps_per_second': 12.048, 'epoch': 2.15}
{'loss': 1.6227, 'grad_norm': 1.4249944686889648, 'learning_rate': 1.3350000000000001e-05, 'epoch': 2.2}
{'eval_loss': 2.0618720054626465, 'eval_runtime': 20.7871, 'eval_samples_per_second': 192.427, 'eval_steps_per_second': 12.027, 'epoch': 2.2}
{'loss': 1.6103, 'grad_norm': 1.3424246311187744, 'learning_rate': 1.2516666666666668e-05, 'epoch': 2.25}
{'eval_loss': 2.064157724380493, 'eval_runtime': 20.6734, 'eval_samples_per_second': 193.486, 'eval_steps_per_second': 12.093, 'epoch': 2.25}
{'loss': 1.631, 'grad_norm': 1.3974180221557617, 'learning_rate': 1.1683333333333334e-05, 'epoch': 2.3}
{'eval_loss': 2.0619850158691406, 'eval_runtime': 20.7137, 'eval_samples_per_second': 193.109, 'eval_steps_per_second': 12.069, 'epoch': 2.3}
{'loss': 1.609, 'grad_norm': 1.3291813135147095, 'learning_rate': 1.0850000000000001e-05, 'epoch': 2.35}
{'eval_loss': 2.0623457431793213, 'eval_runtime': 21.0814, 'eval_samples_per_second': 189.741, 'eval_steps_per_second': 11.859, 'epoch': 2.35}
{'loss': 1.616, 'grad_norm': 1.439315676689148, 'learning_rate': 1.0016666666666667e-05, 'epoch': 2.4}
{'eval_loss': 2.0577471256256104, 'eval_runtime': 20.6865, 'eval_samples_per_second': 193.363, 'eval_steps_per_second': 12.085, 'epoch': 2.4}
{'loss': 1.6087, 'grad_norm': 1.3780767917633057, 'learning_rate': 9.183333333333334e-06, 'epoch': 2.45}
{'eval_loss': 2.059664726257324, 'eval_runtime': 20.9439, 'eval_samples_per_second': 190.986, 'eval_steps_per_second': 11.937, 'epoch': 2.45}
{'loss': 1.6207, 'grad_norm': 1.2832599878311157, 'learning_rate': 8.350000000000001e-06, 'epoch': 2.5}
{'eval_loss': 2.054605007171631, 'eval_runtime': 20.704, 'eval_samples_per_second': 193.2, 'eval_steps_per_second': 12.075, 'epoch': 2.5}
{'loss': 1.605, 'grad_norm': 1.3363573551177979, 'learning_rate': 7.516666666666668e-06, 'epoch': 2.55}
{'eval_loss': 2.0588490962982178, 'eval_runtime': 20.9168, 'eval_samples_per_second': 191.234, 'eval_steps_per_second': 11.952, 'epoch': 2.55}
{'loss': 1.6156, 'grad_norm': 1.4714329242706299, 'learning_rate': 6.6833333333333334e-06, 'epoch': 2.6}
{'eval_loss': 2.056811571121216, 'eval_runtime': 20.7901, 'eval_samples_per_second': 192.4, 'eval_steps_per_second': 12.025, 'epoch': 2.6}
{'loss': 1.6011, 'grad_norm': 1.3691387176513672, 'learning_rate': 5.850000000000001e-06, 'epoch': 2.65}
{'eval_loss': 2.055903434753418, 'eval_runtime': 20.8699, 'eval_samples_per_second': 191.664, 'eval_steps_per_second': 11.979, 'epoch': 2.65}
{'loss': 1.6046, 'grad_norm': 1.2655718326568604, 'learning_rate': 5.016666666666666e-06, 'epoch': 2.7}
{'eval_loss': 2.055135726928711, 'eval_runtime': 20.7243, 'eval_samples_per_second': 193.01, 'eval_steps_per_second': 12.063, 'epoch': 2.7}
{'loss': 1.6161, 'grad_norm': 1.306152105331421, 'learning_rate': 4.183333333333334e-06, 'epoch': 2.75}
{'eval_loss': 2.055953025817871, 'eval_runtime': 20.7213, 'eval_samples_per_second': 193.038, 'eval_steps_per_second': 12.065, 'epoch': 2.75}
{'loss': 1.604, 'grad_norm': 1.3159137964248657, 'learning_rate': 3.3500000000000005e-06, 'epoch': 2.8}
{'eval_loss': 2.0562758445739746, 'eval_runtime': 21.0568, 'eval_samples_per_second': 189.962, 'eval_steps_per_second': 11.873, 'epoch': 2.8}
{'loss': 1.6122, 'grad_norm': 1.1601530313491821, 'learning_rate': 2.516666666666667e-06, 'epoch': 2.85}
{'eval_loss': 2.0535082817077637, 'eval_runtime': 21.0598, 'eval_samples_per_second': 189.935, 'eval_steps_per_second': 11.871, 'epoch': 2.85}
{'loss': 1.601, 'grad_norm': 1.2918280363082886, 'learning_rate': 1.6916666666666668e-06, 'epoch': 2.9}
{'eval_loss': 2.054187536239624, 'eval_runtime': 20.666, 'eval_samples_per_second': 193.554, 'eval_steps_per_second': 12.097, 'epoch': 2.9}
{'loss': 1.6226, 'grad_norm': 1.4344006776809692, 'learning_rate': 8.583333333333334e-07, 'epoch': 2.95}
{'eval_loss': 2.051936626434326, 'eval_runtime': 20.7156, 'eval_samples_per_second': 193.091, 'eval_steps_per_second': 12.068, 'epoch': 2.95}
{'loss': 1.6181, 'grad_norm': 1.6076931953430176, 'learning_rate': 2.5000000000000002e-08, 'epoch': 3.0}
{'eval_loss': 2.0515401363372803, 'eval_runtime': 20.677, 'eval_samples_per_second': 193.452, 'eval_steps_per_second': 12.091, 'epoch': 3.0}
{'train_runtime': 23642.3829, 'train_samples_per_second': 4.061, 'train_steps_per_second': 0.254, 'train_loss': 1.8760354531208674, 'epoch': 3.0}
模型和分词器已保存到 /mnt/file2/changye/model/gpt2-formal-finetuned_short_prompt
