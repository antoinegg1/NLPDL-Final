ËÆ≠ÁªÉÈõÜÂä†ËΩΩÂÆåÊàêÔºåÂÖ±Êúâ 32000 ‰∏™Ê†∑Êú¨„ÄÇ
È™åËØÅÈõÜÂä†ËΩΩÂÆåÊàêÔºåÂÖ±Êúâ 4000 ‰∏™Ê†∑Êú¨„ÄÇ
Ê∑ªÂä†‰∫ÜÂ°´ÂÖÖÊ†áËÆ∞ '[PAD]' Âà∞ÂàÜËØçÂô®„ÄÇ
Êï∞ÊçÆÈ¢ÑÂ§ÑÁêÜÂÆåÊàê„ÄÇ
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
Ê®°ÂûãÂä†ËΩΩÂπ∂Ë∞ÉÊï¥ËØçÊ±áË°®ÂÆåÊàê„ÄÇ
/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/training_args.py:1575: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ü§ó Transformers. Use `eval_strategy` instead
  warnings.warn(
/mnt/file2/changye/NLPFINAL/fine-tuning/trainer.py:72: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
                                                                                                                                             
{'loss': 3.1641, 'grad_norm': 3.3152358531951904, 'learning_rate': 4.999166666666667e-05, 'epoch': 0.0}
{'loss': 1.7299, 'grad_norm': 0.8893259167671204, 'learning_rate': 4.9166666666666665e-05, 'epoch': 0.05}
                                                                                                                                             
{'eval_loss': 1.6487913131713867, 'eval_runtime': 18.9703, 'eval_samples_per_second': 210.856, 'eval_steps_per_second': 13.179, 'epoch': 0.05}
{'loss': 1.664, 'grad_norm': 0.8608300089836121, 'learning_rate': 4.8333333333333334e-05, 'epoch': 0.1}
{'eval_loss': 1.6226531267166138, 'eval_runtime': 20.9098, 'eval_samples_per_second': 191.298, 'eval_steps_per_second': 11.956, 'epoch': 0.1}
{'loss': 1.6452, 'grad_norm': 0.8187181949615479, 'learning_rate': 4.75e-05, 'epoch': 0.15}
{'eval_loss': 1.6074522733688354, 'eval_runtime': 20.8372, 'eval_samples_per_second': 191.965, 'eval_steps_per_second': 11.998, 'epoch': 0.15}
{'loss': 1.6147, 'grad_norm': 0.8169435858726501, 'learning_rate': 4.6675e-05, 'epoch': 0.2}
{'eval_loss': 1.5948015451431274, 'eval_runtime': 18.9514, 'eval_samples_per_second': 211.066, 'eval_steps_per_second': 13.192, 'epoch': 0.2}
{'loss': 1.6189, 'grad_norm': 0.7719640731811523, 'learning_rate': 4.5841666666666665e-05, 'epoch': 0.25}
{'eval_loss': 1.5859726667404175, 'eval_runtime': 21.2173, 'eval_samples_per_second': 188.525, 'eval_steps_per_second': 11.783, 'epoch': 0.25}
{'loss': 1.5924, 'grad_norm': 0.7866792678833008, 'learning_rate': 4.5008333333333334e-05, 'epoch': 0.3}
{'eval_loss': 1.5755714178085327, 'eval_runtime': 21.3626, 'eval_samples_per_second': 187.243, 'eval_steps_per_second': 11.703, 'epoch': 0.3}
{'loss': 1.6124, 'grad_norm': 0.8157630562782288, 'learning_rate': 4.4174999999999996e-05, 'epoch': 0.35}
{'eval_loss': 1.5673928260803223, 'eval_runtime': 19.4002, 'eval_samples_per_second': 206.183, 'eval_steps_per_second': 12.886, 'epoch': 0.35}
{'loss': 1.5867, 'grad_norm': 0.7714687585830688, 'learning_rate': 4.334166666666667e-05, 'epoch': 0.4}
{'eval_loss': 1.5599443912506104, 'eval_runtime': 21.5896, 'eval_samples_per_second': 185.274, 'eval_steps_per_second': 11.58, 'epoch': 0.4}
{'loss': 1.596, 'grad_norm': 0.8352683186531067, 'learning_rate': 4.2508333333333334e-05, 'epoch': 0.45}
{'eval_loss': 1.554839849472046, 'eval_runtime': 22.0922, 'eval_samples_per_second': 181.059, 'eval_steps_per_second': 11.316, 'epoch': 0.45}
{'loss': 1.5652, 'grad_norm': 0.7939798831939697, 'learning_rate': 4.1675e-05, 'epoch': 0.5}
{'eval_loss': 1.5459024906158447, 'eval_runtime': 22.0049, 'eval_samples_per_second': 181.778, 'eval_steps_per_second': 11.361, 'epoch': 0.5}
{'loss': 1.5635, 'grad_norm': 0.8017986416816711, 'learning_rate': 4.0841666666666666e-05, 'epoch': 0.55}
{'eval_loss': 1.5422440767288208, 'eval_runtime': 21.8846, 'eval_samples_per_second': 182.777, 'eval_steps_per_second': 11.424, 'epoch': 0.55}
{'loss': 1.5486, 'grad_norm': 0.7715135812759399, 'learning_rate': 4.0008333333333335e-05, 'epoch': 0.6}
{'eval_loss': 1.5343817472457886, 'eval_runtime': 19.0311, 'eval_samples_per_second': 210.183, 'eval_steps_per_second': 13.136, 'epoch': 0.6}
{'loss': 1.5561, 'grad_norm': 0.8736087679862976, 'learning_rate': 3.9175000000000004e-05, 'epoch': 0.65}
{'eval_loss': 1.5306345224380493, 'eval_runtime': 20.4702, 'eval_samples_per_second': 195.406, 'eval_steps_per_second': 12.213, 'epoch': 0.65}
{'loss': 1.5496, 'grad_norm': 0.7866513133049011, 'learning_rate': 3.834166666666667e-05, 'epoch': 0.7}
{'eval_loss': 1.5249431133270264, 'eval_runtime': 20.7424, 'eval_samples_per_second': 192.842, 'eval_steps_per_second': 12.053, 'epoch': 0.7}
{'loss': 1.5516, 'grad_norm': 0.8342514038085938, 'learning_rate': 3.7508333333333335e-05, 'epoch': 0.75}
{'eval_loss': 1.5208220481872559, 'eval_runtime': 18.9638, 'eval_samples_per_second': 210.928, 'eval_steps_per_second': 13.183, 'epoch': 0.75}
{'loss': 1.551, 'grad_norm': 0.7853996157646179, 'learning_rate': 3.6675000000000004e-05, 'epoch': 0.8}
{'eval_loss': 1.516867756843567, 'eval_runtime': 21.2067, 'eval_samples_per_second': 188.62, 'eval_steps_per_second': 11.789, 'epoch': 0.8}
{'loss': 1.5297, 'grad_norm': 0.8203226327896118, 'learning_rate': 3.5841666666666666e-05, 'epoch': 0.85}
{'eval_loss': 1.511978268623352, 'eval_runtime': 21.4417, 'eval_samples_per_second': 186.552, 'eval_steps_per_second': 11.659, 'epoch': 0.85}
{'loss': 1.5385, 'grad_norm': 0.7342116236686707, 'learning_rate': 3.5008333333333335e-05, 'epoch': 0.9}
{'eval_loss': 1.5095915794372559, 'eval_runtime': 19.1105, 'eval_samples_per_second': 209.309, 'eval_steps_per_second': 13.082, 'epoch': 0.9}
{'loss': 1.5249, 'grad_norm': 0.8310661315917969, 'learning_rate': 3.4175000000000004e-05, 'epoch': 0.95}
{'eval_loss': 1.5052627325057983, 'eval_runtime': 21.6345, 'eval_samples_per_second': 184.89, 'eval_steps_per_second': 11.556, 'epoch': 0.95}
{'loss': 1.5353, 'grad_norm': 0.7228220701217651, 'learning_rate': 3.3341666666666666e-05, 'epoch': 1.0}
{'eval_loss': 1.5014212131500244, 'eval_runtime': 21.6572, 'eval_samples_per_second': 184.696, 'eval_steps_per_second': 11.543, 'epoch': 1.0}
{'loss': 1.3251, 'grad_norm': 0.8589107990264893, 'learning_rate': 3.2508333333333335e-05, 'epoch': 1.05}
{'eval_loss': 1.5109291076660156, 'eval_runtime': 23.6788, 'eval_samples_per_second': 168.928, 'eval_steps_per_second': 10.558, 'epoch': 1.05}
{'loss': 1.3455, 'grad_norm': 0.8393588066101074, 'learning_rate': 3.1675e-05, 'epoch': 1.1}
{'eval_loss': 1.509759545326233, 'eval_runtime': 20.8461, 'eval_samples_per_second': 191.883, 'eval_steps_per_second': 11.993, 'epoch': 1.1}
{'loss': 1.3315, 'grad_norm': 0.8767961859703064, 'learning_rate': 3.0841666666666666e-05, 'epoch': 1.15}
{'eval_loss': 1.5100412368774414, 'eval_runtime': 19.022, 'eval_samples_per_second': 210.283, 'eval_steps_per_second': 13.143, 'epoch': 1.15}
{'loss': 1.3545, 'grad_norm': 0.8442981839179993, 'learning_rate': 3.0008333333333332e-05, 'epoch': 1.2}
{'eval_loss': 1.506729245185852, 'eval_runtime': 20.6834, 'eval_samples_per_second': 193.392, 'eval_steps_per_second': 12.087, 'epoch': 1.2}
{'loss': 1.3522, 'grad_norm': 0.8619428277015686, 'learning_rate': 2.9175e-05, 'epoch': 1.25}
{'eval_loss': 1.5041805505752563, 'eval_runtime': 21.1688, 'eval_samples_per_second': 188.958, 'eval_steps_per_second': 11.81, 'epoch': 1.25}
{'loss': 1.3396, 'grad_norm': 0.8812001943588257, 'learning_rate': 2.8341666666666667e-05, 'epoch': 1.3}
{'eval_loss': 1.5018888711929321, 'eval_runtime': 19.0505, 'eval_samples_per_second': 209.968, 'eval_steps_per_second': 13.123, 'epoch': 1.3}
{'loss': 1.3684, 'grad_norm': 0.8234086036682129, 'learning_rate': 2.7508333333333336e-05, 'epoch': 1.35}
{'eval_loss': 1.4975634813308716, 'eval_runtime': 21.0033, 'eval_samples_per_second': 190.446, 'eval_steps_per_second': 11.903, 'epoch': 1.35}
{'loss': 1.3334, 'grad_norm': 0.8764452338218689, 'learning_rate': 2.6675e-05, 'epoch': 1.4}
{'eval_loss': 1.498583197593689, 'eval_runtime': 21.347, 'eval_samples_per_second': 187.38, 'eval_steps_per_second': 11.711, 'epoch': 1.4}
{'loss': 1.3566, 'grad_norm': 0.8557411432266235, 'learning_rate': 2.584166666666667e-05, 'epoch': 1.45}
{'eval_loss': 1.49525785446167, 'eval_runtime': 19.3055, 'eval_samples_per_second': 207.195, 'eval_steps_per_second': 12.95, 'epoch': 1.45}
{'loss': 1.3253, 'grad_norm': 0.8541006445884705, 'learning_rate': 2.5008333333333332e-05, 'epoch': 1.5}
{'eval_loss': 1.491919755935669, 'eval_runtime': 21.4515, 'eval_samples_per_second': 186.467, 'eval_steps_per_second': 11.654, 'epoch': 1.5}
{'loss': 1.3346, 'grad_norm': 0.7749764919281006, 'learning_rate': 2.4175e-05, 'epoch': 1.55}
{'eval_loss': 1.4904077053070068, 'eval_runtime': 21.7344, 'eval_samples_per_second': 184.04, 'eval_steps_per_second': 11.503, 'epoch': 1.55}
{'loss': 1.3416, 'grad_norm': 0.8019176125526428, 'learning_rate': 2.3341666666666667e-05, 'epoch': 1.6}
{'eval_loss': 1.4882341623306274, 'eval_runtime': 21.2149, 'eval_samples_per_second': 188.547, 'eval_steps_per_second': 11.784, 'epoch': 1.6}
{'loss': 1.3508, 'grad_norm': 0.7995606064796448, 'learning_rate': 2.2508333333333333e-05, 'epoch': 1.65}
{'eval_loss': 1.4854072332382202, 'eval_runtime': 22.4677, 'eval_samples_per_second': 178.033, 'eval_steps_per_second': 11.127, 'epoch': 1.65}
{'loss': 1.3276, 'grad_norm': 0.8663654923439026, 'learning_rate': 2.1675e-05, 'epoch': 1.7}
{'eval_loss': 1.4824633598327637, 'eval_runtime': 22.5136, 'eval_samples_per_second': 177.67, 'eval_steps_per_second': 11.104, 'epoch': 1.7}
{'loss': 1.3335, 'grad_norm': 0.8676949739456177, 'learning_rate': 2.0841666666666667e-05, 'epoch': 1.75}
{'eval_loss': 1.483872890472412, 'eval_runtime': 22.7498, 'eval_samples_per_second': 175.826, 'eval_steps_per_second': 10.989, 'epoch': 1.75}
{'loss': 1.3406, 'grad_norm': 0.8785058259963989, 'learning_rate': 2.0008333333333333e-05, 'epoch': 1.8}
{'eval_loss': 1.4808512926101685, 'eval_runtime': 22.4964, 'eval_samples_per_second': 177.806, 'eval_steps_per_second': 11.113, 'epoch': 1.8}
{'loss': 1.3427, 'grad_norm': 0.8590974807739258, 'learning_rate': 1.9175000000000002e-05, 'epoch': 1.85}
{'eval_loss': 1.4783209562301636, 'eval_runtime': 19.0283, 'eval_samples_per_second': 210.214, 'eval_steps_per_second': 13.138, 'epoch': 1.85}
{'loss': 1.3327, 'grad_norm': 0.8719176650047302, 'learning_rate': 1.8341666666666668e-05, 'epoch': 1.9}
{'eval_loss': 1.476226568222046, 'eval_runtime': 22.8848, 'eval_samples_per_second': 174.789, 'eval_steps_per_second': 10.924, 'epoch': 1.9}
{'loss': 1.3336, 'grad_norm': 0.8444839119911194, 'learning_rate': 1.7508333333333337e-05, 'epoch': 1.95}
{'eval_loss': 1.4748132228851318, 'eval_runtime': 22.7444, 'eval_samples_per_second': 175.867, 'eval_steps_per_second': 10.992, 'epoch': 1.95}
{'loss': 1.3077, 'grad_norm': 0.8478928804397583, 'learning_rate': 1.6675000000000002e-05, 'epoch': 2.0}
{'eval_loss': 1.4745748043060303, 'eval_runtime': 18.9101, 'eval_samples_per_second': 211.527, 'eval_steps_per_second': 13.22, 'epoch': 2.0}
{'loss': 1.1718, 'grad_norm': 0.9812060594558716, 'learning_rate': 1.5841666666666668e-05, 'epoch': 2.05}
{'eval_loss': 1.5084459781646729, 'eval_runtime': 22.3116, 'eval_samples_per_second': 179.279, 'eval_steps_per_second': 11.205, 'epoch': 2.05}
{'loss': 1.1811, 'grad_norm': 0.9456090927124023, 'learning_rate': 1.5008333333333335e-05, 'epoch': 2.1}
{'eval_loss': 1.506479263305664, 'eval_runtime': 21.9966, 'eval_samples_per_second': 181.846, 'eval_steps_per_second': 11.365, 'epoch': 2.1}
{'loss': 1.1767, 'grad_norm': 0.988468587398529, 'learning_rate': 1.4183333333333335e-05, 'epoch': 2.15}
{'eval_loss': 1.5048481225967407, 'eval_runtime': 19.168, 'eval_samples_per_second': 208.682, 'eval_steps_per_second': 13.043, 'epoch': 2.15}
{'loss': 1.1874, 'grad_norm': 1.0429917573928833, 'learning_rate': 1.3350000000000001e-05, 'epoch': 2.2}
{'eval_loss': 1.5031603574752808, 'eval_runtime': 22.0304, 'eval_samples_per_second': 181.568, 'eval_steps_per_second': 11.348, 'epoch': 2.2}
{'loss': 1.1716, 'grad_norm': 0.9734268188476562, 'learning_rate': 1.2516666666666668e-05, 'epoch': 2.25}
{'eval_loss': 1.50497305393219, 'eval_runtime': 21.1216, 'eval_samples_per_second': 189.379, 'eval_steps_per_second': 11.836, 'epoch': 2.25}
{'loss': 1.1932, 'grad_norm': 0.9725570678710938, 'learning_rate': 1.1683333333333334e-05, 'epoch': 2.3}
{'eval_loss': 1.5026580095291138, 'eval_runtime': 21.2457, 'eval_samples_per_second': 188.273, 'eval_steps_per_second': 11.767, 'epoch': 2.3}
{'loss': 1.1662, 'grad_norm': 0.9609540700912476, 'learning_rate': 1.0850000000000001e-05, 'epoch': 2.35}
{'eval_loss': 1.504550576210022, 'eval_runtime': 21.876, 'eval_samples_per_second': 182.849, 'eval_steps_per_second': 11.428, 'epoch': 2.35}
{'loss': 1.1804, 'grad_norm': 0.9817127585411072, 'learning_rate': 1.0016666666666667e-05, 'epoch': 2.4}
{'eval_loss': 1.501567006111145, 'eval_runtime': 19.1873, 'eval_samples_per_second': 208.471, 'eval_steps_per_second': 13.029, 'epoch': 2.4}
{'loss': 1.1689, 'grad_norm': 1.0108466148376465, 'learning_rate': 9.183333333333334e-06, 'epoch': 2.45}
{'eval_loss': 1.5015925168991089, 'eval_runtime': 21.8249, 'eval_samples_per_second': 183.277, 'eval_steps_per_second': 11.455, 'epoch': 2.45}
{'loss': 1.1827, 'grad_norm': 0.9307991862297058, 'learning_rate': 8.350000000000001e-06, 'epoch': 2.5}
{'eval_loss': 1.498893141746521, 'eval_runtime': 22.0332, 'eval_samples_per_second': 181.544, 'eval_steps_per_second': 11.346, 'epoch': 2.5}
{'loss': 1.1688, 'grad_norm': 0.9673973917961121, 'learning_rate': 7.516666666666668e-06, 'epoch': 2.55}
{'eval_loss': 1.5002644062042236, 'eval_runtime': 19.1003, 'eval_samples_per_second': 209.421, 'eval_steps_per_second': 13.089, 'epoch': 2.55}
{'loss': 1.1749, 'grad_norm': 1.0239869356155396, 'learning_rate': 6.6833333333333334e-06, 'epoch': 2.6}
{'eval_loss': 1.4994558095932007, 'eval_runtime': 22.9394, 'eval_samples_per_second': 174.372, 'eval_steps_per_second': 10.898, 'epoch': 2.6}
{'loss': 1.1626, 'grad_norm': 1.0185718536376953, 'learning_rate': 5.850000000000001e-06, 'epoch': 2.65}
{'eval_loss': 1.4977749586105347, 'eval_runtime': 22.5075, 'eval_samples_per_second': 177.719, 'eval_steps_per_second': 11.107, 'epoch': 2.65}
{'loss': 1.1663, 'grad_norm': 0.9589676260948181, 'learning_rate': 5.016666666666666e-06, 'epoch': 2.7}
{'eval_loss': 1.4973901510238647, 'eval_runtime': 19.1444, 'eval_samples_per_second': 208.938, 'eval_steps_per_second': 13.059, 'epoch': 2.7}
{'loss': 1.1812, 'grad_norm': 0.9565138816833496, 'learning_rate': 4.183333333333334e-06, 'epoch': 2.75}
{'eval_loss': 1.4964150190353394, 'eval_runtime': 22.679, 'eval_samples_per_second': 176.375, 'eval_steps_per_second': 11.023, 'epoch': 2.75}
{'loss': 1.1759, 'grad_norm': 1.078380823135376, 'learning_rate': 3.3500000000000005e-06, 'epoch': 2.8}
{'eval_loss': 1.4972127676010132, 'eval_runtime': 22.4599, 'eval_samples_per_second': 178.095, 'eval_steps_per_second': 11.131, 'epoch': 2.8}
{'loss': 1.1763, 'grad_norm': 0.8761617541313171, 'learning_rate': 2.516666666666667e-06, 'epoch': 2.85}
{'eval_loss': 1.4956210851669312, 'eval_runtime': 22.833, 'eval_samples_per_second': 175.185, 'eval_steps_per_second': 10.949, 'epoch': 2.85}
{'loss': 1.1635, 'grad_norm': 0.9395771622657776, 'learning_rate': 1.6833333333333332e-06, 'epoch': 2.9}
{'eval_loss': 1.4960070848464966, 'eval_runtime': 22.6022, 'eval_samples_per_second': 176.974, 'eval_steps_per_second': 11.061, 'epoch': 2.9}
{'loss': 1.1878, 'grad_norm': 1.001413106918335, 'learning_rate': 8.500000000000001e-07, 'epoch': 2.95}
{'eval_loss': 1.4949517250061035, 'eval_runtime': 21.2968, 'eval_samples_per_second': 187.821, 'eval_steps_per_second': 11.739, 'epoch': 2.95}
{'loss': 1.177, 'grad_norm': 1.094811201095581, 'learning_rate': 1.6666666666666667e-08, 'epoch': 3.0}
{'eval_loss': 1.494692325592041, 'eval_runtime': 21.2795, 'eval_samples_per_second': 187.974, 'eval_steps_per_second': 11.748, 'epoch': 3.0}
{'train_runtime': 24331.2681, 'train_samples_per_second': 3.946, 'train_steps_per_second': 0.247, 'train_loss': 1.366336659193039, 'epoch': 3.0}
Ê®°ÂûãÂíåÂàÜËØçÂô®Â∑≤‰øùÂ≠òÂà∞ /mnt/file2/changye/model/gpt2-formal-finetuned
