训练集加载完成，共有 32000 个样本。
验证集加载完成，共有 4000 个样本。
数据预处理完成。
/home/changye/miniconda3/envs/ML/lib/python3.10/site-packages/transformers/training_args.py:1575: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
/mnt/file2/changye/NLPFINAL/fine-tuning/trainer.py:109: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Seq2SeqTrainer.__init__`. Use `processing_class` instead.
  trainer = Seq2SeqTrainer(
  0%|                                                                                                                               | 0/6000 [00:00<?, ?it/s]Passing a tuple of `past_key_values` is deprecated and will be removed in Transformers v4.48.0. You should pass an instance of `EncoderDecoderCache` instead, e.g. `past_key_values=EncoderDecoderCache.from_legacy_cache(past_key_values)`.
                                                                                                                                                             
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.0}
{'loss': 0.0134, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.05}
                                                                                                                                                             
{'eval_loss': nan, 'eval_runtime': 26.4033, 'eval_samples_per_second': 151.496, 'eval_steps_per_second': 9.469, 'epoch': 0.05}
{'loss': 0.0107, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.1}
{'eval_loss': nan, 'eval_runtime': 28.1019, 'eval_samples_per_second': 142.339, 'eval_steps_per_second': 8.896, 'epoch': 0.1}
{'loss': 0.0062, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.15}
{'eval_loss': nan, 'eval_runtime': 27.8376, 'eval_samples_per_second': 143.691, 'eval_steps_per_second': 8.981, 'epoch': 0.15}
{'loss': 0.0131, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.2}
{'eval_loss': nan, 'eval_runtime': 26.4495, 'eval_samples_per_second': 151.231, 'eval_steps_per_second': 9.452, 'epoch': 0.2}
{'loss': 0.0107, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.25}
{'eval_loss': nan, 'eval_runtime': 27.9791, 'eval_samples_per_second': 142.964, 'eval_steps_per_second': 8.935, 'epoch': 0.25}
{'loss': 0.1082, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.3}
{'eval_loss': nan, 'eval_runtime': 26.8916, 'eval_samples_per_second': 148.745, 'eval_steps_per_second': 9.297, 'epoch': 0.3}
{'loss': 0.0034, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.35}
{'eval_loss': nan, 'eval_runtime': 26.4419, 'eval_samples_per_second': 151.275, 'eval_steps_per_second': 9.455, 'epoch': 0.35}
{'loss': 0.0125, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.4}
{'eval_loss': nan, 'eval_runtime': 28.1135, 'eval_samples_per_second': 142.28, 'eval_steps_per_second': 8.893, 'epoch': 0.4}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.45}
{'eval_loss': nan, 'eval_runtime': 27.722, 'eval_samples_per_second': 144.29, 'eval_steps_per_second': 9.018, 'epoch': 0.45}
{'loss': 0.0041, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.5}
{'eval_loss': nan, 'eval_runtime': 27.9332, 'eval_samples_per_second': 143.199, 'eval_steps_per_second': 8.95, 'epoch': 0.5}
{'loss': 0.0039, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.55}
{'eval_loss': nan, 'eval_runtime': 28.1333, 'eval_samples_per_second': 142.181, 'eval_steps_per_second': 8.886, 'epoch': 0.55}
{'loss': 0.0094, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.6}
{'eval_loss': nan, 'eval_runtime': 26.7691, 'eval_samples_per_second': 149.426, 'eval_steps_per_second': 9.339, 'epoch': 0.6}
{'loss': 0.0064, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.65}
{'eval_loss': nan, 'eval_runtime': 27.9108, 'eval_samples_per_second': 143.314, 'eval_steps_per_second': 8.957, 'epoch': 0.65}
{'loss': 0.0063, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.7}
{'eval_loss': nan, 'eval_runtime': 27.9205, 'eval_samples_per_second': 143.264, 'eval_steps_per_second': 8.954, 'epoch': 0.7}
{'loss': 0.0041, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.75}
{'eval_loss': nan, 'eval_runtime': 26.3817, 'eval_samples_per_second': 151.62, 'eval_steps_per_second': 9.476, 'epoch': 0.75}
{'loss': 0.0385, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.8}
{'eval_loss': nan, 'eval_runtime': 27.9993, 'eval_samples_per_second': 142.861, 'eval_steps_per_second': 8.929, 'epoch': 0.8}
{'loss': 0.0043, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.85}
{'eval_loss': nan, 'eval_runtime': 27.9427, 'eval_samples_per_second': 143.15, 'eval_steps_per_second': 8.947, 'epoch': 0.85}
{'loss': 0.0171, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.9}
{'eval_loss': nan, 'eval_runtime': 26.3134, 'eval_samples_per_second': 152.014, 'eval_steps_per_second': 9.501, 'epoch': 0.9}
{'loss': 0.0107, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 0.95}
{'eval_loss': nan, 'eval_runtime': 27.9491, 'eval_samples_per_second': 143.117, 'eval_steps_per_second': 8.945, 'epoch': 0.95}
{'loss': 0.0061, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.0}
{'eval_loss': nan, 'eval_runtime': 27.8141, 'eval_samples_per_second': 143.812, 'eval_steps_per_second': 8.988, 'epoch': 1.0}
{'loss': 0.0129, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.05}
{'eval_loss': nan, 'eval_runtime': 27.9922, 'eval_samples_per_second': 142.897, 'eval_steps_per_second': 8.931, 'epoch': 1.05}
{'loss': 0.0021, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.1}
{'eval_loss': nan, 'eval_runtime': 27.3804, 'eval_samples_per_second': 146.09, 'eval_steps_per_second': 9.131, 'epoch': 1.1}
{'loss': 0.0056, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.15}
{'eval_loss': nan, 'eval_runtime': 27.5604, 'eval_samples_per_second': 145.136, 'eval_steps_per_second': 9.071, 'epoch': 1.15}
{'loss': 0.0039, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.2}
{'eval_loss': nan, 'eval_runtime': 27.217, 'eval_samples_per_second': 146.967, 'eval_steps_per_second': 9.185, 'epoch': 1.2}
{'loss': 0.0252, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.25}
{'eval_loss': nan, 'eval_runtime': 27.3839, 'eval_samples_per_second': 146.071, 'eval_steps_per_second': 9.129, 'epoch': 1.25}
{'loss': 0.0113, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.3}
{'eval_loss': nan, 'eval_runtime': 26.3353, 'eval_samples_per_second': 151.887, 'eval_steps_per_second': 9.493, 'epoch': 1.3}
{'loss': 0.0236, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.35}
{'eval_loss': nan, 'eval_runtime': 27.5468, 'eval_samples_per_second': 145.208, 'eval_steps_per_second': 9.075, 'epoch': 1.35}
{'loss': 0.0781, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.4}
{'eval_loss': nan, 'eval_runtime': 27.5216, 'eval_samples_per_second': 145.34, 'eval_steps_per_second': 9.084, 'epoch': 1.4}
{'loss': 0.0209, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.45}
{'eval_loss': nan, 'eval_runtime': 26.6437, 'eval_samples_per_second': 150.129, 'eval_steps_per_second': 9.383, 'epoch': 1.45}
{'loss': 0.0146, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.5}
{'eval_loss': nan, 'eval_runtime': 27.3137, 'eval_samples_per_second': 146.447, 'eval_steps_per_second': 9.153, 'epoch': 1.5}
{'loss': 0.0156, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.55}
{'eval_loss': nan, 'eval_runtime': 27.5198, 'eval_samples_per_second': 145.35, 'eval_steps_per_second': 9.084, 'epoch': 1.55}
{'loss': 0.0092, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.6}
{'eval_loss': nan, 'eval_runtime': 27.3627, 'eval_samples_per_second': 146.185, 'eval_steps_per_second': 9.137, 'epoch': 1.6}
{'loss': 0.0215, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.65}
{'eval_loss': nan, 'eval_runtime': 27.6358, 'eval_samples_per_second': 144.74, 'eval_steps_per_second': 9.046, 'epoch': 1.65}
{'loss': 0.018, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.7}
{'eval_loss': nan, 'eval_runtime': 26.3904, 'eval_samples_per_second': 151.57, 'eval_steps_per_second': 9.473, 'epoch': 1.7}
{'loss': 0.0531, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.75}
{'eval_loss': nan, 'eval_runtime': 27.7447, 'eval_samples_per_second': 144.172, 'eval_steps_per_second': 9.011, 'epoch': 1.75}
{'loss': 0.0026, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.8}
{'eval_loss': nan, 'eval_runtime': 27.6103, 'eval_samples_per_second': 144.873, 'eval_steps_per_second': 9.055, 'epoch': 1.8}
{'loss': 0.0082, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.85}
{'eval_loss': nan, 'eval_runtime': 26.2669, 'eval_samples_per_second': 152.283, 'eval_steps_per_second': 9.518, 'epoch': 1.85}
{'loss': 0.0123, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.9}
{'eval_loss': nan, 'eval_runtime': 27.647, 'eval_samples_per_second': 144.681, 'eval_steps_per_second': 9.043, 'epoch': 1.9}
{'loss': 0.0017, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 1.95}
{'eval_loss': nan, 'eval_runtime': 27.6548, 'eval_samples_per_second': 144.64, 'eval_steps_per_second': 9.04, 'epoch': 1.95}
{'loss': 0.0237, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.0}
{'eval_loss': nan, 'eval_runtime': 26.2097, 'eval_samples_per_second': 152.615, 'eval_steps_per_second': 9.538, 'epoch': 2.0}
{'loss': 0.0065, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.05}
{'eval_loss': nan, 'eval_runtime': 28.0757, 'eval_samples_per_second': 142.472, 'eval_steps_per_second': 8.905, 'epoch': 2.05}
{'loss': 0.0087, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.1}
{'eval_loss': nan, 'eval_runtime': 27.1312, 'eval_samples_per_second': 147.431, 'eval_steps_per_second': 9.214, 'epoch': 2.1}
{'loss': 0.0011, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.15}
{'eval_loss': nan, 'eval_runtime': 27.1121, 'eval_samples_per_second': 147.536, 'eval_steps_per_second': 9.221, 'epoch': 2.15}
{'loss': 0.0474, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.2}
{'eval_loss': nan, 'eval_runtime': 27.3114, 'eval_samples_per_second': 146.459, 'eval_steps_per_second': 9.154, 'epoch': 2.2}
{'loss': 0.0017, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.25}
{'eval_loss': nan, 'eval_runtime': 27.3507, 'eval_samples_per_second': 146.248, 'eval_steps_per_second': 9.141, 'epoch': 2.25}
{'loss': 0.0226, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.3}
{'eval_loss': nan, 'eval_runtime': 27.4036, 'eval_samples_per_second': 145.966, 'eval_steps_per_second': 9.123, 'epoch': 2.3}
{'loss': 0.0025, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.35}
{'eval_loss': nan, 'eval_runtime': 27.3942, 'eval_samples_per_second': 146.016, 'eval_steps_per_second': 9.126, 'epoch': 2.35}
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.4}
{'eval_loss': nan, 'eval_runtime': 26.4302, 'eval_samples_per_second': 151.342, 'eval_steps_per_second': 9.459, 'epoch': 2.4}
{'loss': 0.0099, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.45}
{'eval_loss': nan, 'eval_runtime': 27.7926, 'eval_samples_per_second': 143.923, 'eval_steps_per_second': 8.995, 'epoch': 2.45}
{'loss': 0.0335, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.5}
{'eval_loss': nan, 'eval_runtime': 27.7877, 'eval_samples_per_second': 143.949, 'eval_steps_per_second': 8.997, 'epoch': 2.5}
{'loss': 0.0053, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.55}
{'eval_loss': nan, 'eval_runtime': 26.1879, 'eval_samples_per_second': 152.742, 'eval_steps_per_second': 9.546, 'epoch': 2.55}
{'loss': 0.0023, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.6}
{'eval_loss': nan, 'eval_runtime': 28.1904, 'eval_samples_per_second': 141.892, 'eval_steps_per_second': 8.868, 'epoch': 2.6}
{'loss': 0.0317, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.65}
{'eval_loss': nan, 'eval_runtime': 27.8614, 'eval_samples_per_second': 143.568, 'eval_steps_per_second': 8.973, 'epoch': 2.65}
{'loss': 0.0038, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.7}
{'eval_loss': nan, 'eval_runtime': 27.8495, 'eval_samples_per_second': 143.629, 'eval_steps_per_second': 8.977, 'epoch': 2.7}
{'loss': 0.0203, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.75}
{'eval_loss': nan, 'eval_runtime': 27.7906, 'eval_samples_per_second': 143.934, 'eval_steps_per_second': 8.996, 'epoch': 2.75}
{'loss': 0.0081, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.8}
{'eval_loss': nan, 'eval_runtime': 26.2998, 'eval_samples_per_second': 152.093, 'eval_steps_per_second': 9.506, 'epoch': 2.8}
{'loss': 0.0018, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.85}
{'eval_loss': nan, 'eval_runtime': 27.902, 'eval_samples_per_second': 143.359, 'eval_steps_per_second': 8.96, 'epoch': 2.85}
{'loss': 0.0066, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.9}
{'eval_loss': nan, 'eval_runtime': 28.1434, 'eval_samples_per_second': 142.129, 'eval_steps_per_second': 8.883, 'epoch': 2.9}
{'loss': 0.068, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 2.95}
{'eval_loss': nan, 'eval_runtime': 27.103, 'eval_samples_per_second': 147.585, 'eval_steps_per_second': 9.224, 'epoch': 2.95}
{'loss': 0.0076, 'grad_norm': nan, 'learning_rate': 3e-05, 'epoch': 3.0}
{'eval_loss': nan, 'eval_runtime': 27.7376, 'eval_samples_per_second': 144.209, 'eval_steps_per_second': 9.013, 'epoch': 3.0}
{'train_runtime': 22839.743, 'train_samples_per_second': 4.203, 'train_steps_per_second': 0.263, 'train_loss': 0.015710092624028525, 'epoch': 3.0}
模型和分词器已保存到 /mnt/file2/changye/model/t5-formal-finetuned
